#### INSTRUCTIONS FOR RUNNING MOMI2 ON WAHAB ####
#First make ind2pop.txt file that associates individuals with populations
#list of individuals and then their populations, tab separated

#will run momi2 on gzipped all sites vcf
#filter all sites vcf to just individuals you want (right species, site, no highhet individuals)
#create index file of this vcf with tabix

#create sfs to run momi2 on
#first, create allele counts

salloc
module load container_env python3
bash

#make allele counts file to make SFS from
crun.python3 -p ~/.conda/envs/momi-py36 python -m momi.read_vcf --no_aa <VCF GZ> ind2pop.txt <VCF.allelecounts>
#zip allele counts file

#make SFS
crun.python3 -p ~/.conda/envs/momi-py36 python -m momi.extract_sfs <VCF.sfs.gz> 100 <VCF.allelecounts>

#read SFS into momi and run models
salloc
module load container_env python3
bash
crun.python3 -p ~/.conda/envs/momi-py36 python
import momi
from autograd.numpy import log

sfsfile="<SFS.gz>"
sfs = momi.Sfs.load(sfsfile)
NeConstant=1e4

#check file
print("populations", sfs.populations)
print("percent missing data per population", sfs.p_missing)

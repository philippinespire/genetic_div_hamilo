#### PLOTTING 2D SFS ####

### AEN
##MAKE SFS IN EASYSFS
salloc
module load container_env python3
cd easySFS
crun.python3 -p ~/.conda/envs/easySFS ./easySFS.py -i ~/PIRE/atherinomorus_endrachtensis/aen.all.A.nohighhet.vcf -p Aen_popfile.txt --preview -a #sampling ALL SNPs

#look at downsampling
#want to maximize # segregating sites (2nd #) but also need to balance sample size (1st #, 2X popsize) in both pops/timepoints
AHam
(2, 364) (3, 484) (4, 594) (5, 603) (6, 667) (7, 620) (8, 664) (9, 602) 
(10, 635) (11, 532) (12, 557) (13, 387) (14, 403)

CBat
(2, 308) (3, 461) (4, 562) (5, 635) (6, 692) (7, 739) (8, 778) (9, 811)
(10, 840) (11, 866) (12, 889) (13, 909) (14, 928) (15, 945) (16, 960) (17, 975)
(18, 988) (19, 1001) (20, 1012) (21, 1023) (22, 1033) (23, 1043) (24, 1052)
(25, 1061) (26, 1069) (27, 1077) (28, 1085) (29, 1092) (30, 1099) (31, 1105)
(32, 1112) (33, 1118) (34, 1124) (35, 1129) (36, 1135) (37, 1140) (38, 1145) 
(39, 1150) (40, 1155) (41, 1159) (42, 1164) (43, 1168) (44, 1172) (45, 1176)
(46, 1180) (47, 1184) (48, 1188) (49, 1192) (50, 1195) (51, 1199) (52, 1202)
(53, 1206) (54, 1209) (55, 1212) (56, 1215) (57, 1218) (58, 1221) (59, 1224)
(60, 1227) (61, 1230) (62, 1233) (63, 1236) (64, 1238) (65, 1241) (66, 1243)
(67, 1246) (68, 1249) (69, 1251) (70, 1253) (71, 1256) (72, 1258) (73, 1260)
(74, 1263) (75, 1265) (76, 1267) (77, 1269) (78, 1271) (79, 1274) (80, 1276)
(81, 1278) (82, 1280) (83, 1282) (84, 1284) (85, 1286) (86, 1288) (87, 1290)
(88, 1291) (89, 1293) (90, 1295) (91, 1297) (92, 1299) (93, 1301) (94, 1302)
(95, 1304) (96, 1306) (97, 1308) (98, 1309) (99, 1311) (100, 1313) (101, 1314)
(102, 1316) (103, 1318) (104, 1319) (105, 1321) (106, 1322) (107, 1324) (108, 1325)
(109, 1327) (110, 1328) (111, 1330) (112, 1331) (113, 1333) (114, 1334) (115, 1336)
(116, 1337) (117, 1339) (118, 1340) (119, 1342) (120, 1343) (121, 1344) (122, 1346)
(123, 1347) (124, 1349) (125, 1350) (126, 1351) (127, 1353) (128, 1354) (129, 1355)
(130, 1357) (131, 1358) (132, 1359) (133, 1361) (134, 1362) (135, 1363) (136, 1364)
(137, 1366) (138, 1367) (139, 1368) (140, 1369) (141, 1371) (142, 1372) (143, 1373)
(144, 1374) (145, 1376) (146, 1377) (147, 1377) (148, 1378) (149, 1379) (150, 1380)
(151, 1381) (152, 1382) (153, 1382) (154, 1383) (155, 1381) (156, 1382) (157, 1377)
(158, 1378) (159, 1369) (160, 1370) (161, 1365) (162, 1366) (163, 1358) (164, 1359)
(165, 1349) (166, 1350) (167, 1329) (168, 1330) (169, 1312) (170, 1313) (171, 1299)
(172, 1300) (173, 1277) (174, 1278) (175, 1250) (176, 1251) (177, 1222) (178, 1223)
(179, 1185) (180, 1186) (181, 1142) (182, 1142) (183, 1049) (184, 1050)

crun.python3 -p ~/.conda/envs/easySFS ./easySFS.py -i ~/PIRE/atherinomorus_endrachtensis/aen.all.A.nohighhet.vcf -p Aen_popfile.txt --proj 10,156 -o Aen_output_10_156 -a -f

##PLOT WITH DADI
cd Aen_output_10_156/dadi
crun.python3 -p ~/.conda/envs/dadi python
import matplotlib.pyplot as pyplot
import dadi
data = dadi.Spectrum.from_file("AHam-CBat.sfs")
data.sample_sizes #make sure read in right, should match what downsample projections were

fig = pyplot.figure(219033)
fig.clear()
dadi.Plotting.plot_single_2d_sfs(data, vmin=0.01) #vmin means won't plot allele freqs <0.01 (bc log scale, would look funky)
fig.savefig("Aen_2D_SFS_10_156.png")

### AEN UNRELATED
##MAKE SFS IN EASYSFS
salloc
module load container_env python3
cd easySFS
crun.python3 -p ~/.conda/envs/easySFS ./easySFS.py -i ~/PIRE/atherinomorus_endrachtensis/aen.all.A.nohighhet.unrelated.vcf -p Aen_unrelated_popfile.txt --preview -a #sampling ALL SNPs

#look at downsampling
#want to maximize # segregating sites (2nd #) but also need to balance sample size (1st #, 2X popsize) in both pops/timepoints
AHam
(2, 364) (3, 484) (4, 594) (5, 603) (6, 667) (7, 620) (8, 664) (9, 602) (10, 635)
(11, 532) (12, 557) (13, 387) (14, 403)

CBat
(2, 308) (3, 462) (4, 563) (5, 636) (6, 694) (7, 740) (8, 779) (9, 813) (10, 842)
(11, 868) (12, 891) (13, 911) (14, 930) (15, 947) (16, 963) (17, 977) (18, 991)
(19, 1003) (20, 1015) (21, 1026) (22, 1036) (23, 1046) (24, 1055) (25, 1064) 
(26, 1073) (27, 1080) (28, 1088) (29, 1095) (30, 1102) (31, 1109) (32, 1115)
(33, 1121) (34, 1127) (35, 1133) (36, 1138) (37, 1144) (38, 1149) (39, 1154)
(40, 1159) (41, 1163) (42, 1168) (43, 1172) (44, 1177) (45, 1181) (46, 1185)
(47, 1189) (48, 1192) (49, 1196) (50, 1200) (51, 1203) (52, 1207) (53, 1210)
(54, 1214) (55, 1217) (56, 1220) (57, 1223) (58, 1226) (59, 1229) (60, 1232)
(61, 1235) (62, 1238) (63, 1241) (64, 1243) (65, 1246) (66, 1249) (67, 1251) 
(68, 1254) (69, 1256) (70, 1259) (71, 1261) (72, 1263) (73, 1266) (74, 1268)
(75, 1270) (76, 1273) (77, 1275) (78, 1277) (79, 1279) (80, 1281) (81, 1283)
(82, 1285) (83, 1287) (84, 1290) (85, 1292) (86, 1293) (87, 1295) (88, 1297)
(89, 1299) (90, 1301) (91, 1303) (92, 1305) (93, 1307) (94, 1308) (95, 1310)
(96, 1312) (97, 1314) (98, 1316) (99, 1317) (100, 1319) (101, 1321) (102, 1322)
(103, 1324) (104, 1326) (105, 1327) (106, 1329) (107, 1330) (108, 1332) (109, 1334) 
(110, 1335) (111, 1337) (112, 1338) (113, 1340) (114, 1341) (115, 1343) (116, 1344)
(117, 1346) (118, 1347) (119, 1349) (120, 1350) (121, 1351) (122, 1353) (123, 1354)
(124, 1356) (125, 1357) (126, 1359) (127, 1360) (128, 1361) (129, 1363) (130, 1364)
(131, 1365) (132, 1367) (133, 1368) (134, 1369) (135, 1371) (136, 1372) (137, 1371)
(138, 1372) (139, 1372) (140, 1373) (141, 1372) (142, 1374) (143, 1369) (144, 1370)
(145, 1363) (146, 1364) (147, 1358) (148, 1359) (149, 1350) (150, 1351) (151, 1332)
(152, 1333) (153, 1319) (154, 1320) (155, 1302) (156, 1303) (157, 1281) (158, 1282)
(159, 1255) (160, 1256) (161, 1222) (162, 1223) (163, 1186) (164, 1187) (165, 1143)
(166, 1144) (167, 1050) (168, 1051)

crun.python3 -p ~/.conda/envs/easySFS ./easySFS.py -i ~/PIRE/atherinomorus_endrachtensis/aen.all.A.nohighhet.unrelated.vcf -p Aen_unrelated_popfile.txt --proj 10,144 -o Aen_unrelated_output_10_144 -a -f

##PLOT WITH DADI
cd Aen_unrelated_output_10_144/dadi
crun.python3 -p ~/.conda/envs/dadi python
import matplotlib.pyplot as pyplot
import dadi
data = dadi.Spectrum.from_file("AHam-CBat.sfs")
data.sample_sizes #make sure read in right, should match what downsample projections were

fig = pyplot.figure(219033)
fig.clear()
dadi.Plotting.plot_single_2d_sfs(data, vmin=0.01) #vmin means won't plot allele freqs <0.01 (bc log scale, would look funky)
fig.savefig("Aen_unrelated_2D_SFS_10_144.png")

### GMI
##MAKE SFS IN EASYSFS
salloc
module load container_env python3
cd easySFS
crun.python3 -p ~/.conda/envs/easySFS ./easySFS.py -i ~/PIRE/gazza_minuta/gmi.all.A.nohighhet.Ham.vcf -p Gmi_popfile.txt --preview -a #sampling ALL SNPs

AHam
(2, 756) (3, 1134) (4, 1421) (5, 1664) (6, 1877) (7, 2069) (8, 2245) (9, 2407)
(10, 2558) (11, 2700) (12, 2833) (13, 2959) (14, 3079) (15, 3193) (16, 3302) 
(17, 3405) (18, 3505) (19, 3599) (20, 3691) (21, 3775) (22, 3860) (23, 3936)
(24, 4015) (25, 4048) (26, 4121) (27, 4079) (28, 4146) (29, 3908) (30, 3966)
(31, 3417) (32, 3465) (33, 2616) (34, 2651) (35, 1563) (36, 1583)

CBat
(2, 763) (3, 1144) (4, 1440) (5, 1693) (6, 1918) (7, 2123) (8, 2312) (9, 2488)
(10, 2653) (11, 2809) (12, 2956) (13, 3096) (14, 3230) (15, 3358) (16, 3480)
(17, 3597) (18, 3710) (19, 3818) (20, 3923) (21, 4023) (22, 4120) (23, 4214)
(24, 4305) (25, 4393) (26, 4478) (27, 4560) (28, 4640) (29, 4717) (30, 4793)
(31, 4866) (32, 4937) (33, 5006) (34, 5073) (35, 5138) (36, 5202) (37, 5264)
(38, 5324) (39, 5383) (40, 5440) (41, 5496) (42, 5550) (43, 5603) (44, 5655)
(45, 5706) (46, 5755) (47, 5800) (48, 5847) (49, 5893) (50, 5938) (51, 5981)
(52, 6024) (53, 6065) (54, 6106) (55, 6147) (56, 6186) (57, 6225) (58, 6262)
(59, 6297) (60, 6333) (61, 6366) (62, 6400) (63, 6428) (64, 6462) (65, 6483)
(66, 6515) (67, 6526) (68, 6557) (69, 6551) (70, 6580) (71, 6536) (72, 6564)
(73, 6474) (74, 6501) (75, 6283) (76, 6308) (77, 5961) (78, 5984) (79, 5410)
(80, 5430) (81, 4357) (82, 4373) (83, 2722) (84, 2732)

crun.python3 -p ~/.conda/envs/easySFS ./easySFS.py -i ~/PIRE/gazza_minuta/gmi.all.A.nohighhet.Ham.vcf -p Gmi_popfile.txt --proj 28,72 -o Gmi_output_28_72 -a -f

##PLOT WITH DADI
cd Gmi_output_28_72/dadi
crun.python3 -p ~/.conda/envs/dadi python
import matplotlib.pyplot as pyplot
import dadi
data = dadi.Spectrum.from_file("AHam-CBat.sfs")
data.sample_sizes #make sure read in right, should match what downsample projections were

fig = pyplot.figure(219033)
fig.clear()
dadi.Plotting.plot_single_2d_sfs(data, vmin=0.01) #vmin means won't plot allele freqs <0.01 (bc log scale, would look funky)
fig.savefig("Gmi_2D_SFS_28_72.png")

### ELA
##MAKE SFS IN EASYSFS
salloc
module load container_env python3
cd easySFS
crun.python3 -p ~/.conda/envs/easySFS ./easySFS.py -i ~/PIRE/leiognathus_leuciscus/lle.all.ela.nohighhet.vcf -p Lle_popfile.txt --preview -a #sampling ALL SNPs

AHam
(2, 6262) (3, 9393) (4, 11662) (5, 13500) (6, 15069) (7, 16451) (8, 17693) 
(9, 18824) (10, 19864) (11, 20619) (12, 21511) (13, 21782) (14, 22553) (15, 22539)
(16, 23210) (17, 22637) (18, 23219) (19, 21186) (20, 21665)

CNas
(2, 5880) (3, 8821) (4, 10933) (5, 12631) (6, 14072) (7, 15335) (8, 16465)
(9, 17491) (10, 18433) (11, 19305) (12, 20118) (13, 20879) (14, 21595) (15, 22271)
(16, 22911) (17, 23520) (18, 24099) (19, 24652) (20, 25181) (21, 25688) (22, 26174)
(23, 26641) (24, 27090) (25, 27523) (26, 27940) (27, 28343) (28, 28732) (29, 29108)
(30, 29472) (31, 29825) (32, 30167) (33, 30498) (34, 30820) (35, 31132) (36, 31436)
(37, 31731) (38, 32018) (39, 32297) (40, 32569) (41, 32833) (42, 33091) (43, 33342)
(44, 33587) (45, 33826) (46, 34059) (47, 34287) (48, 34509) (49, 34726) (50, 34938)
(51, 35145) (52, 35347) (53, 35545) (54, 35738) (55, 35927) (56, 36113) (57, 36294)
(58, 36471) (59, 36644) (60, 36814) (61, 36980) (62, 37143) (63, 37303) (64, 37459)
(65, 37612) (66, 37762) (67, 37910) (68, 38054) (69, 38195) (70, 38334) (71, 38470)
(72, 38603) (73, 38734) (74, 38863) (75, 38989) (76, 39112) (77, 39234) (78, 39353)
(79, 39470) (80, 39585) (81, 39697) (82, 39808) (83, 39917) (84, 40024) (85, 40128)
(86, 40232) (87, 40333) (88, 40432) (89, 40530) (90, 40626) (91, 40720) (92, 40813)
(93, 40902) (94, 40992) (95, 41077) (96, 41163) (97, 41243) (98, 41327) (99, 41405)
(100, 41486) (101, 41559) (102, 41638) (103, 41709) (104, 41784) (105, 41855)
(106, 41928) (107, 41993) (108, 42063) (109, 42123) (110, 42192) (111, 42249)
(112, 42315) (113, 42368) (114, 42433) (115, 42486) (116, 42548) (117, 42598)
(118, 42658) (119, 42707) (120, 42766) (121, 42816) (122, 42872) (123, 42918)
(124, 42973) (125, 43002) (126, 43055) (127, 43087) (128, 43138) (129, 43177)
(130, 43227) (131, 43253) (132, 43301) (133, 43318) (134, 43365) (135, 43376)
(136, 43422) (137, 43434) (138, 43478) (139, 43496) (140, 43539) (141, 43544)
(142, 43585) (143, 43574) (144, 43614) (145, 43599) (146, 43637) (147, 43628)
(148, 43666) (149, 43645) (150, 43681) (151, 43668) (152, 43703) (153, 43677)
(154, 43711) (155, 43674) (156, 43707) (157, 43681) (158, 43713) (159, 43674)
(160, 43705) (161, 43656) (162, 43686) (163, 43618) (164, 43647) (165, 43584)
(166, 43613) (167, 43517) (168, 43545) (169, 43425) (170, 43452) (171, 43355)
(172, 43380) (173, 43248) (174, 43273) (175, 43105) (176, 43129) (177, 42953)
(178, 42976) (179, 42690) (180, 42712) (181, 42344) (182, 42365) (183, 41591)
(184, 41612) (185, 39383) (186, 39402)

crun.python3 -p ~/.conda/envs/easySFS ./easySFS.py -i ~/PIRE/leiognathus_leuciscus/lle.all.ela.nohighhet.vcf -p Lle_popfile.txt --proj 18,160 -o Lle_output_18_160 -a -f

##PLOT WITH DADI
cd Lle_output_18_160/dadi
crun.python3 -p ~/.conda/envs/dadi python
import matplotlib.pyplot as pyplot
import dadi
data = dadi.Spectrum.from_file("AHam-CNas.sfs")
data.sample_sizes #make sure read in right, should match what downsample projections were

fig = pyplot.figure(219033)
fig.clear()
dadi.Plotting.plot_single_2d_sfs(data, vmin=0.01) #vmin means won't plot allele freqs <0.01 (bc log scale, would look funky)
fig.savefig("Lle_2D_SFS_18_160.png")